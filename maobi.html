<!DOCTYPE html>
<html lang="zh">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>智慧毛笔评分系统</title>
    <link rel="stylesheet" href="maobi.css">
    <link rel="stylesheet" href="person.css">
    <link rel="stylesheet" href="./xinli.css">
</head>

<body>
    <div class="main-scream">
        <svg class="icon-shufa" aria-hidden="true" id="shufa-icon">
            <use xlink:href="#icon-maobi1"></use>
        </svg>
        <div id="messageContainer" class="messageContainer">
            <p>今天你练字了吗？</p>
            <button onclick="response('yes')">练了</button>
            <button onclick="response('no')">没练</button>
        </div>
        <div id="feedbackMessage" class="messageContainer">
            <p id="feedbackText"></p>
            <button onclick="closeFeedback()">关闭</button>
        </div>

        <span class="buttonword"><img src="春节毛笔风格.png" class="spring" id="springword" alt="点击播放语音"></span>
        <audio id="voice" src="ttsmaker-file-2024-9-21-22-22-3.mp3"></audio>

        <!-- 图片上传 -->
        <div class="album">
            <input type="file" id="imageInputAlbum" class="file-input hidden" accept="image/*">
            <label for="imageInputAlbum" class="picture-word" id="pictureWord">落笔</label>
        </div>

        <!-- 评分结果弹出框 -->
        <div id="scoreContainer" class="hidden">

            <div class="content-container">
                <!-- 分数页 -->
                <div id="scoresPage" class="page">
                    <table id="scoreTable">
                        <tbody>
                            <tr id="scoreNames"></tr>
                            <tr id="scoreValues"></tr>
                        </tbody>
                    </table>
                </div>
                <!-- 柱形图页 -->
                <div id="chartPage" class="page hidden">
                    <div class="bar-chart-container">
                        <canvas id="scoreChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="navigation">
                <button id="prevButton" onclick="showScores()" class="hidden">上一页&lt;</button>
                <button id="nextButton" onclick="showChart()">下一页&gt;</button>
                <button type="button" id="closeButton" onclick="closeScoreForm()">关闭</button>
            </div>

        </div>



        <img src="./水墨，竹子，.png" alt="背景竹" class="background1">
    </div>

    <!-- 历史记录 -->
    <div class="xinlizixunzhuanjia-scream">
        <svg class="teshuzuojiantou" aria-hidden="true">
            <use xlink:href="#icon-a-teshuzuojiantou"></use>
        </svg>
        <h5>心情记录</h5>
        <table>
            <tbody id="historyTableBody"></tbody>
        </table>
    </div>
    <div class="Halloween-scream">
        <div class="mmain-scream">
            <!-- 头像和昵称部分 -->
            <div class="avatar-container">
                <div class="avatar" id="avatar"></div>
                <input type="file" id="imageInput" accept="image/*" style="display: none;">
            </div>

            <p class="nickname" id="nickname">双击修改昵称</p>
        </div>
        <!-- 称号选择 -->
        <div class="title-container">
            <select id="titleSelect" onchange="updateTitle()">
                <option value="初级书法家">初级书法家</option>
                <option value="中级书法家">中级书法家</option>
                <option value="高级书法家">高级书法家</option>
                <option value="王羲之本之">王羲之本之</option>
            </select>
            <p id="currentTitle" class="current-title">初级书法家</p>
        </div>
        <!-- 昵称修改框 -->
        <div id="nicknameEditContainer" class="nickname-edit-container">
            <input type="text" id="nicknameInput" placeholder="请输入新的昵称">
            <button onclick="saveNickname()">保存</button>
        </div>
        <!-- 统计信息 -->
        <div class="stats-container-dark">
            <div class="stat-item">
                <p class="stat-number">32次</p>
                <p class="stat-label">练字次数</p>
            </div>
            <div class="stat-item">
                <p class="stat-number">298</p>
                <p class="stat-label">粉丝</p>
            </div>
            <div class="stat-item">
                <p class="stat-number">832</p>
                <p class="stat-label">收到的赞</p>
            </div>
        </div>
        <!-- 备忘录 -->
        <div id="memoContainer" class="memo-container">
            <h2>每日收获</h2>
            <textarea id="memoInput" maxlength="200" placeholder="输入每日收获..."></textarea>
            <button onclick="saveMemo()">保存备忘录</button>
        </div>

        <!-- 日历表格 -->
        <div class="calendar-container">
            <table id="calendar"></table>
        </div>
        <svg class="teshuzuojiantou" aria-hidden="true" id="back">
            <use xlink:href="#icon-a-teshuzuojiantou"></use>
        </svg>
    </div>
    <div class="qing-scream">
        <!-- 头部 -->
        <div class="header">
            <div class="header-left">
                <span class="back-icon">

                </span>
                <span class="title-shu">匿名书法圈</span>
            </div>
            <div class="header-right">
                <span class="filter-icon">⚙️</span>
            </div>
        </div>
        <!-- 点赞评论转发图标 -->
        <div>
            <svg class="xianxingaixin" aria-hidden="true">
                <use xlink:href="#icon-a-xianxingaixin"></use>
            </svg>
            <svg class="xianxingaixin1" aria-hidden="true">
                <use xlink:href="#icon-a-mianxingaixin"></use>
            </svg>

            <svg class="xianxingpinglun" aria-hidden="true">
                <use xlink:href="#icon-a-xianxingpinglun"></use>
            </svg>
            <svg class="xianxingfenxiang" aria-hidden="true">
                <use xlink:href="#icon-a-xianxingfenxiang"></use>
            </svg>
        </div>
        <svg class="teshuzuojiantou" aria-hidden="true">
            <use xlink:href="#icon-a-teshuzuojiantou"></use>
        </svg>
        <div class="photo-container">
            <img id="random-image" src="" alt="Random" style="max-width: 100%; max-height: 100%; position: relative;" />
        </div>
    </div>
    <div class="classicon">
        <svg class="icon-huabi" aria-hidden="true">
            <use xlink:href="#icon-weibiaoti--"></use>
        </svg>
        <svg class="icon-Halloween-" aria-hidden="true">
            <use xlink:href="#icon-wo"></use>
        </svg>
        <svg class="icon-qing" aria-hidden="true">
            <use xlink:href="#icon-pengyouquan"></use>
        </svg>
        <svg class="icon-xinlizixunzhuanjia" aria-hidden="true">
            <use xlink:href="#icon-xiaotaiyang"></use>
        </svg>
    </div>

    <script src="maobi.js"></script>
    <script src="./download (6)/font_rnp90fa13w/iconfont.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        let chartInstance = null; // 用于存储图表实例
        let evaluationIcon = null; // 用于存储评价图标

        document.getElementById('imageInputAlbum').addEventListener('change', function (event) {
            var file = event.target.files[0];
            if (!file) {
                return;
            }

            var formData = new FormData();
            formData.append('image', file);

            fetch('http://127.0.0.1:5000/predict', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    showScoreForm(data);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        });

        function showScoreForm(data) {
            let scoreContainer = document.getElementById('scoreContainer');
            scoreContainer.classList.remove('hidden');

            let scoreNamesRow = document.getElementById('scoreNames');
            let scoreValuesRow = document.getElementById('scoreValues');

            // Clear previous results including evaluation row
            scoreNamesRow.innerHTML = '<th>项目</th>';
            scoreValuesRow.innerHTML = '<th>评分</th>';

            let evaluationRow = document.createElement('tr');
            evaluationRow.innerHTML = '<th>评价</th>';

            let labels = [];
            let scores = [];

            if (data.error) {
                scoreNamesRow.innerHTML = '<td colspan="3">Error: ' + data.error + '</td>';
            } else {
                for (let key in data) {
                    if (data.hasOwnProperty(key)) {
                        let originalScore = data[key];
                        let scoreConverted = ((originalScore + 7) / 14) * 100;

                        labels.push(key);
                        scores.push(scoreConverted.toFixed(2));

                        scoreNamesRow.innerHTML += '<td>' + key + '</td>';
                        scoreValuesRow.innerHTML += '<td>' + scoreConverted.toFixed(2) + '</td>';

                        // Determine the evaluation image based on score
                        if (scoreConverted >= 80) {
                            evaluationIcon = './image/5.png';
                        } else if (scoreConverted >= 60) {
                            evaluationIcon = './image/4.png';
                        } else if (scoreConverted >= 40) {
                            evaluationIcon = './image/3.png';
                        } else if (scoreConverted >= 20) {
                            evaluationIcon = './image/2.png';
                        } else {
                            evaluationIcon = './image/1.png';
                        }

                        evaluationRow.innerHTML += '<td><img src="' + evaluationIcon + '" alt="评价图标" style="width: 20px; height: 20px;"></td>';
                    }
                }

                let scoreTable = document.getElementById('scoreTable');
                // Remove existing evaluation row if it exists
                if (scoreTable.rows.length > 2) {
                    scoreTable.deleteRow(2);
                }
                scoreTable.appendChild(evaluationRow);

                // 如果已存在旧的图表实例，先销毁它
                if (chartInstance) {
                    chartInstance.destroy();
                }

                chartInstance = new Chart(document.getElementById('scoreChart'), {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '评分',
                            data: scores,
                            backgroundColor: 'rgba(0, 123, 255, 0.5)',
                            borderColor: 'rgba(0, 123, 255, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }

            // 默认展示分数页
            showScores();
        }


        function showScores() {
            document.getElementById('scoresPage').classList.remove('hidden');
            document.getElementById('chartPage').classList.add('hidden');
            document.getElementById('prevButton').classList.add('hidden');
            document.getElementById('nextButton').classList.remove('hidden');
        }

        function showChart() {
            document.getElementById('chartPage').classList.remove('hidden');
            document.getElementById('scoresPage').classList.add('hidden');
            document.getElementById('nextButton').classList.add('hidden');
            document.getElementById('prevButton').classList.remove('hidden');
        }

        function closeScoreForm() {
            document.getElementById('scoreContainer').classList.add('hidden');
        }


    </script>


    <script>
        function displayHistory(data) {
            const tableBody = document.getElementById('historyTableBody');
            tableBody.innerHTML = ''; // 清空之前的内容

            if (data.error) {
                const row = tableBody.insertRow();
                row.innerHTML = '<td colspan="3">Error: ' + data.error + '</td>';
            } else {
                data.forEach(record => {
                    // 创建主行
                    const mainRow = tableBody.insertRow();

                    // 时间列
                    const timestampCell = mainRow.insertCell();
                    timestampCell.rowSpan = 3; // 跨三行
                    timestampCell.textContent = '检测时间: ' + new Date(record['Timestamp']).toLocaleString();


                    // 图片列
                    const imageCell = mainRow.insertCell();
                    imageCell.rowSpan = 3; // 跨三行

                    // 使用Flask提供的图片URL
                    const imageName = record['ImageName'];
                    const imagePath = `http://127.0.0.1:5000/images/${imageName}`;

                    imageCell.innerHTML = `<img src="${imagePath}" style="width: 100px; height: auto;">`;

                    // 评价单元格，分布在三行中
                    addEvaluationCells(mainRow, record, 0);
                    for (let j = 1; j <= 2; j++) {
                        const extraRow = tableBody.insertRow();
                        addEvaluationCells(extraRow, record, j * 2);
                    }

                    // 插入分割行
                    const separatorRow = tableBody.insertRow();
                    const separatorCell = separatorRow.insertCell();
                    separatorCell.colSpan = 4;
                    separatorCell.style.borderBottom = "1px solid #ccc";
                });
            }
        }


        function addEvaluationCells(row, record, startIndex) {
            const evaluationKeys = ['EI', '美观', '情绪', '自控', '情感', '社交'];
            for (let i = startIndex; i < startIndex + 2; i++) {
                if (i < evaluationKeys.length) {
                    const key = evaluationKeys[i];
                    const score = record[key];
                    const iconSrc = getEvaluationIcon(score);
                    const cell = row.insertCell();
                    cell.innerHTML = `<div style="text-align: center;"><span>${key}</span><br><img src="${iconSrc}" style="width: 20px; height: 20px;" alt="${key}"></div>`;
                }
            }
        }

        function getEvaluationIcon(score) {
            const percentileScore = ((score + 7) / 14) * 100;
            if (percentileScore >= 80) {
                return './image/5.png';
            } else if (percentileScore >= 60) {
                return './image/4.png';
            } else if (percentileScore >= 40) {
                return './image/3.png';
            } else if (percentileScore >= 20) {
                return './image/2.png';
            } else {
                return './image/1.png';
            }
        }


        function fetchHistory() {
            fetch('http://127.0.0.1:5000/history')
                .then(response => response.json())
                .then(data => {
                    displayHistory(data);
                })
                .catch(error => {
                    console.error('Error fetching history data:', error);
                });
        }

    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const shufaIcon = document.getElementById('shufa-icon');
            const messageContainer = document.getElementById('messageContainer');
            const feedbackContainer = document.getElementById('feedbackMessage');

            // 点击图标，显示第一个对话框
            shufaIcon.addEventListener('click', showMessage);

            function showMessage() {
                console.log("图标被点击");
                messageContainer.classList.add('active'); // 淡入显示对话框
            }

            window.response = function (answer) {
                console.log("选择的**:", answer);
                const message = answer === 'yes' ? '祝你妙笔生花！' : '今天也要加油哦！';

                // 动态切换第一个对话框到第二个对话框
                fadeOut(messageContainer, function () {
                    // 显示反馈信息
                    document.getElementById('feedbackText').innerText = message;
                    fadeIn(feedbackContainer);
                });
            }

            // 关闭反馈对话框
            window.closeFeedback = function () {
                fadeOut(feedbackContainer);
            }

            // 淡出动画函数
            function fadeOut(element, callback) {
                element.classList.add('fade-out'); // 添加渐出效果
                setTimeout(function () {
                    element.classList.remove('active', 'fade-out'); // 完全隐藏并移除淡出类
                    if (callback) callback(); // 执行回调（比如显示下一个对话框）
                }, 500); // 等待动画结束
            }

            // 淡入动画函数
            function fadeIn(element) {
                element.classList.add('active'); // 显示并渐入
            }

        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 获取所有页面内容区域
            const mainScream = document.querySelector('.main-scream');
            const xinlizixunzhuanjiaScream = document.querySelector('.xinlizixunzhuanjia-scream');
            const halloweenScream = document.querySelector('.Halloween-scream');
            const qingScream = document.querySelector('.qing-scream');

            // 获取导航栏图标
            const huabiIcon = document.querySelector('.icon-huabi');
            const xinlizixunzhuanjiaIcon = document.querySelector('.icon-xinlizixunzhuanjia');
            const halloweenIcon = document.querySelector('.icon-Halloween-');
            const qingIcon = document.querySelector('.icon-qing');
            const backicon = document.querySelectorAll('.teshuzuojiantou');


            // 页面初始化，默认显示主页面内容
            showPage(mainScream);

            // 点击“智慧毛笔”图标，显示主页面内容
            huabiIcon.addEventListener('click', function () {
                // 为当前页面添加动画类
                mainScream.classList.add('slide-in');

                location.href = 'chat.html';
            });

            // 点击“心理咨询专家”图标，显示心理学堂内容
            xinlizixunzhuanjiaIcon.addEventListener('click', function () {
                showPage(xinlizixunzhuanjiaScream);
                fetchHistory();
            });

            // 点击“万圣节”图标，显示万圣节内容
            halloweenIcon.addEventListener('click', function () {
                showPage(halloweenScream);
            });

            // 点击“情感咨询”图标，显示情感咨询内容
            qingIcon.addEventListener('click', function () {
                showPage(qingScream);
                // 获取小信信和小信信1图标
                const xiaoxinxinIcon = document.querySelector('.xianxingaixin');
                const xiaoxinxin1Icon = document.querySelector('.xianxingaixin1');

                let isLiked = false; // 初始化点赞状态

                // 点击“小信信”图标，切换图标
                xiaoxinxinIcon.addEventListener('click', function () {
                    if (!isLiked) {
                        // 添加动画类
                        xiaoxinxinIcon.classList.add('fade-out');
                        // 等待动画结束后切换图标
                        xiaoxinxinIcon.addEventListener('animationend', function () {
                            // 切换图标的可见性
                            xiaoxinxinIcon.style.display = 'none'; // 隐藏小信信图标
                            xiaoxinxin1Icon.style.display = 'block'; // 显示小信信1图标
                            xiaoxinxin1Icon.classList.add('fade-in'); // 添加出现动画
                            isLiked = true; // 设置为已点赞状态
                        }, { once: true }); // 确保事件只触发一次
                    } else {
                        // 取消点赞，返回原来的样式
                        xiaoxinxin1Icon.classList.add('fade-out');
                        xiaoxinxin1Icon.addEventListener('animationend', function () {
                            xiaoxinxin1Icon.style.display = 'none'; // 隐藏小信信1图标
                            xiaoxinxinIcon.style.display = 'block'; // 显示小信信图标
                            xiaoxinxinIcon.classList.add('fade-in'); // 添加出现动画
                            isLiked = false; // 设置为未点赞状态
                        }, { once: true });
                    }
                });
            });


            // 为每个 .teshuzuojiantou 元素添加点击事件监听器
            backicon.forEach(icon => {
                icon.addEventListener('click', () => {
                    showPage(mainScream);
                });
            });

            // 函数：显示指定页面，隐藏其他页面
            function showPage(pageToShow) {
                // 隐藏所有页面内容
                hideAllPages();

                // 为当前页面添加动画类
                pageToShow.classList.add('slide-in');

                // 显示指定页面内容
                pageToShow.style.display = 'block';

                // 处理 Halloween 图标的显示
                if (pageToShow === mainScream) {
                    halloweenIcon.style.display = 'block';
                } else {
                    halloweenIcon.style.display = 'none';
                }
            }

            // 函数：隐藏所有页面内容
            function hideAllPages() {
                mainScream.style.display = 'none';
                xinlizixunzhuanjiaScream.style.display = 'none';
                halloweenScream.style.display = 'none';
                qingScream.style.display = 'none';

                // 移除动画类
                mainScream.classList.remove('slide-in');
                xinlizixunzhuanjiaScream.classList.remove('slide-in');
                halloweenScream.classList.remove('slide-in');
                qingScream.classList.remove('slide-in');
            }
        });

    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const avatarElement = document.getElementById('avatar');
            const imageInput = document.getElementById('imageInput');
            const nicknameElement = document.getElementById('nickname');
            const nicknameEditContainer = document.getElementById('nicknameEditContainer');
            const nicknameInput = document.getElementById('nicknameInput');

            // Load avatar and nickname from local storage
            const savedAvatar = localStorage.getItem('avatar');
            const savedNickname = localStorage.getItem('nickname');
            if (savedAvatar) {
                avatarElement.style.backgroundImage = `url(${savedAvatar})`;
            }
            if (savedNickname) {
                nicknameElement.textContent = savedNickname;
            }

            // Handle avatar upload
            avatarElement.addEventListener('click', function () {
                imageInput.click();  // 触发文件选择窗口
            });

            imageInput.addEventListener('change', function (event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const avatarUrl = e.target.result;
                        avatarElement.style.backgroundImage = `url(${avatarUrl})`;
                        localStorage.setItem('avatar', avatarUrl); // Save avatar to local storage
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Allow editing nickname on double-click or touch
            const editNickname = () => {
                nicknameEditContainer.classList.add('active');
                nicknameInput.value = nicknameElement.textContent;
            };

            // Add event listeners for both double click and touch
            nicknameElement.addEventListener('dblclick', editNickname);
            nicknameElement.addEventListener('touchend', function (event) {
                // Prevents triggering a click event
                if (event.target === nicknameElement) {
                    editNickname();
                    event.preventDefault(); // Prevent potential click event
                }
            });

            // Save modified nickname
            window.saveNickname = function () {
                const newNickname = nicknameInput.value;
                if (newNickname) {
                    nicknameElement.textContent = newNickname;
                    localStorage.setItem('nickname', newNickname);
                    nicknameEditContainer.classList.remove('active');
                }
            };
        });
        // 生成日历
        function generateCalendar() {
            const calendar = document.getElementById('calendar');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            const currentDate = today.getDate();
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

            let months = ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"];
            let table = `<tr><th colspan="7">${months[currentMonth]} ${currentYear}</th></tr>`;
            table += '<tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr>';

            let date = 1;
            for (let i = 0; i < 6; i++) {
                table += '<tr>';
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < firstDay) {
                        // 空白格子不可点击
                        table += '<td class="inactive"></td>';
                    } else if (date > daysInMonth) {
                        // 超出日期范围的格子不可点击
                        table += '<td class="inactive"></td>';
                    } else {
                        const memo = localStorage.getItem('memo-' + currentYear + '-' + currentMonth + '-' + date);
                        const className = memo ? 'filled' : '';
                        table += `<td class="${className}" data-date="${date}">${date}</td>`;
                        date++;
                    }
                }
                table += '</tr>';
            }
            calendar.innerHTML = table;

            // 为每个有效日期添加点击事件
            calendar.querySelectorAll('td[data-date]').forEach(td => {
                td.addEventListener('click', function () {
                    const selectedDate = this.getAttribute('data-date');
                    openMemo(currentYear, currentMonth, selectedDate);
                });
            });
        }
        generateCalendar();

        // 备忘录处理
        const memoContainer = document.getElementById('memoContainer');
        const memoInput = document.getElementById('memoInput');
        let selectedYear, selectedMonth, selectedDate;

        function openMemo(year, month, date) {
            selectedYear = year;
            selectedMonth = month;
            selectedDate = date;
            const savedMemo = localStorage.getItem('memo-' + selectedYear + '-' + selectedMonth + '-' + selectedDate);
            memoInput.value = savedMemo || '';
            memoContainer.classList.add('active');
        }

        function saveMemo() {
            const memo = memoInput.value.trim();
            if (memo) {
                localStorage.setItem('memo-' + selectedYear + '-' + selectedMonth + '-' + selectedDate, memo);
            } else {
                // 如果备忘录为空，则删除存储，并且将日期恢复为默认颜色
                localStorage.removeItem('memo-' + selectedYear + '-' + selectedMonth + '-' + selectedDate);
            }
            memoContainer.classList.remove('active');
            generateCalendar(); // 重新生成日历，更新格子颜色
        }
        // 显示/隐藏称号选择
        document.getElementById('currentTitle').onclick = function () {
            const select = document.getElementById('titleSelect');
            select.style.display = select.style.display === 'none' ? 'block' : 'none';
        };

        // 更新称号显示
        function updateTitle() {
            const selectedTitle = document.getElementById('titleSelect').value;
            document.getElementById('currentTitle').innerText = selectedTitle;
            document.getElementById('titleSelect').style.display = 'none';
        }// 页面加载时读取 localStorage 中的称号并更新显示
        window.onload = function () {
            const savedTitle = localStorage.getItem('userTitle');
            if (savedTitle) {
                document.getElementById('currentTitle').innerText = savedTitle;
                document.getElementById('titleSelect').value = savedTitle;
            }
        };

        // 用户选择称号时，更新当前显示并保存到 localStorage
        function updateTitle() {
            const selectedTitle = document.getElementById('titleSelect').value;
            document.getElementById('currentTitle').innerText = selectedTitle;
            document.getElementById('titleSelect').style.display = 'none';

            // 保存到 localStorage
            localStorage.setItem('userTitle', selectedTitle);
        }

    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let likeCount = localStorage.getItem('likeCount') || 0;
            document.getElementById('like-count').innerText = likeCount;
            // 点赞按钮点击事件
            document.getElementById('like-btn').addEventListener('click', function () {
                likeCount++;
                document.getElementById('like-count').innerText = likeCount;
                localStorage.setItem('likeCount', likeCount); // 存储点赞数
            });

            // 打开评论框
            const commentBtn = document.getElementById('comment-btn');
            const commentPopup = document.getElementById('comment-popup');
            commentBtn.addEventListener('click', function () {
                commentPopup.style.display = 'block';
            });

            // 发送评论
            const sendCommentBtn = document.getElementById('send-comment-btn');
            sendCommentBtn.addEventListener('click', function () {
                const comment = document.getElementById('comment-input').value;
                if (comment.trim()) {
                    alert(`你的评论：${comment}`);
                    document.getElementById('comment-input').value = ''; // 清空输入框
                    commentPopup.style.display = 'none'; // 关闭评论框
                }
            });

            // 点击页面其他地方关闭评论框
            document.addEventListener('click', function (event) {
                if (!commentPopup.contains(event.target) && event.target !== commentBtn) {
                    commentPopup.style.display = 'none';
                }
            });
        });
    </script>
    <script>
        const images = [
            './照片\\src=http___ci.xiaohongshu.com_a448a007-3e99-4040-813a-f0a7e24b326c_imageView2_2_w_1080_format_jpg&refer=http___ci.xiaohongshu.webp',
            './照片\\src=http___ci.xiaohongshu.com_d96093fb-dc57-384e-b7d4-5dcb4a83e496_imageView2_2_w_1080_format_jpg&refer=http___ci.xiaohongshu.webp',
            './照片\\u=1339205807,3822666822&fm=253&fmt=auto&app=138&f=JPEG.webp',
            './照片\\u=1454793238,1827929807&fm=253&app=138&f=JPEG.jpg.crdownload',
            './照片\\u=2457016932,678583520&fm=253&fmt=auto&app=138&f=JPEG.webp',
            './照片\\u=2515501666,1341727497&fm=253&fmt=auto&app=138&f=JPEG.webp',
            './照片\\u=3386036430,1796729630&fm=253&fmt=auto&app=120&f=JPEG.webp',
            './照片\\u=3754993874,4183746320&fm=253&app=138&f=JPEG.jpg.crdownload',
            './照片\\u=4284045341,2541082569&fm=253&app=138&f=JPEG.jpg.crdownload',
            './照片\\v2-add8f77f314fc5685cae261c3f2fb74e_r.jpg',
    
        ];

        let currentIndex = 0;
        let likeCount = 0;

        const imageElement = document.getElementById('random-image');

        function showImage(index) {
            imageElement.src = images[index];
            imageElement.classList.add('fade-in');
            setTimeout(() => {
                imageElement.classList.remove('fade-in');
            }, 500);
        }
        function nextImage() {
            currentIndex = (currentIndex + 1) % images.length;
            showImage(currentIndex);
        }
        function previousImage() {
            currentIndex = (currentIndex - 1 + images.length) % images.length;
            showImage(currentIndex);
        }
        // 监听手势
        let touchStartX = 0;
        imageElement.addEventListener('touchstart', (event) => {
            touchStartX = event.touches[0].clientX;
        });
        imageElement.addEventListener('touchend', (event) => {
            const touchEndX = event.changedTouches[0].clientX;
            const distance = touchEndX - touchStartX;

            if (distance > 50) {
                previousImage();
            } else if (distance < -50) {
                nextImage();
            }
        });

        // 初始显示第一张图片
        showImage(currentIndex);
    </script>
</body>